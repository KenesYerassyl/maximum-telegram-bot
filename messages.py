from sheets_attendance import check_attendance
from aiogram.types.base import Boolean

# attendance fsm messages
ATTENDANCE_MESSAGE = "–ü–æ—Å–µ—â—è–µ–º–æ—Å—Ç—å"
SPECIFY_ATTENDANCE_DATE_MESSAGE = "“ö–∞–π –∫“Ø–Ω–¥—ñ –∫”©—Ä–≥—ñ“£—ñ–∑ –∫–µ–ª–µ–¥—ñ"
TODAY_MESSAGE = "–ë“Ø–≥—ñ–Ω"
OTHER_DATE_MESSAGE = "–ë–∞—Å“õ–∞ –∫“Ø–Ω"
DATE_SPECS_MESSAGE = "–ë—ñ–ª–≥—ñ“£—ñ–∑ –∫–µ–ª–≥–µ–Ω –∫“Ø–Ω–¥—ñ ***–∫–∫/–∞–∞*** —Ç“Ø—Ä—ñ–Ω–¥–µ –∂–∞–∑—ã–ø –∂—ñ–±–µ—Ä—ñ“£—ñ–∑. –ú—ã—Å–∞–ª—ã 01/06 –¥–µ–≥–µ–Ω 1-—à—ñ –ú–∞—É—Å—ã–º –¥–µ–≥–µ–Ω–¥—ñ –±—ñ–ª–¥—ñ—Ä–µ–¥—ñ."

MONTH_RU = {
    "01" : "–Ø–Ω–≤–∞—Ä—å",
    "02" : "–§–µ–≤—Ä–∞–ª—å",
    "03" : "–ú–∞—Ä—Ç",
    "04" : "–ê–ø—Ä–µ–ª—å",
    "05" : "–ú–∞–π",
    "06" : "–ò—é–Ω—å",
    "07" : "–ò—é–ª—å",
    "08" : "–ê–≤–≥—É—Å—Ç",
    "09" : "–°–µ–Ω—Ç—è–±—Ä—å",
    "10" : "–û–∫—Ç—è–±—Ä—å",
    "11" : "–ù–æ—è–±—Ä—å",
    "12" : "–î–µ–∫–∞–±—Ä—å"
}

MONTH_KZ = {
    "01" : "“ö–∞“£—Ç–∞—Ä",
    "02" : "–ê“õ–ø–∞–Ω",
    "03" : "–ù–∞—É—Ä—ã–∑",
    "04" : "–°”ô—É—ñ—Ä",
    "05" : "–ú–∞–º—ã—Ä",
    "06" : "–ú–∞—É—Å—ã–º",
    "07" : "–®—ñ–ª–¥–µ",
    "08" : "–¢–∞–º—ã–∑",
    "09" : "“ö—ã—Ä–∫“Ø–π–µ–∫",
    "10" : "“ö–∞–∑–∞–Ω",
    "11" : "“ö–∞—Ä–∞—à–∞",
    "12" : "–ñ–µ–ª—Ç–æ“õ—Å–∞–Ω"
}

# review fsm messages
REVIEW_MESSAGE = "–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å –±–µ—Ä—É"
REVIEW_CONTENT_MESSAGE = "–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å “õ–∞–ª–¥—ã—Ä“ì—ã“£—ã–∑ –∫–µ–ª–≥–µ–Ω—ñ “Ø—à—ñ–Ω —Ä–∞—Ö–º–µ—Ç!\n\n–°—ñ–∑ –º–∞“ì–∞–Ω –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã“£ –º–∞–∑–º“±–Ω—ã–Ω –∂—ñ–±–µ—Ä–≥–µ–Ω–Ω–µ–Ω –∫–µ–π—ñ–Ω, —Å—ñ–∑–¥–µ –æ–Ω—ã —Ç–µ–∫—Å–µ—Ä—É–≥–µ –∂”ô–Ω–µ –∂—ñ–±–µ—Ä—É–¥–µ–Ω –±–∞—Å—Ç–∞—Ä—Ç—É“ì–∞ –º“Ø–º–∫—ñ–Ω–¥—ñ–∫ –±–æ–ª–∞–¥—ã.\n\n–ú–∞“ì–∞–Ω –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã“£ –º”ô—Ç—ñ–Ω—ñ–Ω –∂—ñ–±–µ—Ä—ñ“£—ñ–∑."
REVIEWER_NAME_MESSAGE = "–ö–µ—Ä–µ–º–µ—Ç! –ï–Ω–¥—ñ –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å –±–µ—Ä—É—à—ñ–Ω—ñ“£ –∞—Ç—ã–Ω –∂”©–Ω—ñ–Ω –∂—ñ–±–µ—Ä—ñ“£—ñ–∑."
REVIEW_ASSESSMENT_MESSAGE = "”®—Ç–µ –∂–∞“õ—Å—ã! –ë—ñ–∑–¥—ñ“£ –º–µ–∫–µ–º–µ–Ω—ñ“£ –∂“±–º—ã—Å—ã–Ω–∞ “õ–∞–Ω—à–∞–ª—ã“õ—Ç—ã –∫”©“£—ñ–ª—ñ“£—ñ–∑ —Ç–æ–ª–∞–¥—ã? –¢”©–º–µ–Ω–¥–µ —à—ã“õ“õ–∞–Ω –∞—Ä–Ω–∞–π—ã —Å–º–∞–π–ª–∏–∫—Ç–µ—Ä –∞—Ä“õ—ã–ª—ã –∂–∞—É–∞–ø –±–µ—Ä—ñ“£—ñ–∑."
REVIEW_ASSESSMENT_KEYBOARD_SET = ['üò°', 'üôÅ', 'üòê', 'üòá', 'üòÅ']
REVIEW_ASSESSMENT_FAILURE_MESSAGE = "”®—Ç—ñ–Ω—ñ—à, –±–∞“ì–∞ –±–µ—Ä—É “Ø—à—ñ–Ω –∞—Å—Ç—ã–Ω–¥–∞ —à—ã“õ“õ–∞–Ω —Å–º–∞–π–ª–∏–∫—Ç–µ—Ä–¥—ñ –ø–∞–π–¥–∞–ª–∞–Ω—ã“£—ã–∑."
REVIEW_CONFIRMATION_MESSAGE = "–û—Å—ã –∫“Ø–π–¥–µ –∂—ñ–±–µ—Ä–≥—ñ“£—ñ–∑ –∫–µ–ª–µ–¥—ñ –º–µ?"
REVIEW_ACCEPT_MESSAGE = "–ò”ô"
REVIEW_CANCEL_MESSAGE = "–ñ–æ“õ"
REVIEW_CONFIRMATION_FAILURE_MESSAGE = "”®—Ç—ñ–Ω—ñ—à, –∞—Å—Ç—ã–Ω–¥–∞ —à—ã“õ“õ–∞–Ω –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä –∞—Ä“õ—ã–ª—ã –∂–∞—É–∞–ø –±–µ—Ä—ñ“£—ñ–∑."
REVIEW_CANCELLATION_MESSAGE = f"–°—ñ–∑–¥—ñ“£ –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å—ã“£—ã–∑ –∂–æ–π—ã–ª–¥—ã. –ï–≥–µ—Ä –±–∞—Å—ã–Ω–∞–Ω –∂—ñ–±–µ—Ä–≥—ñ“£—ñ–∑ –∫–µ–ª—Å–µ ***{REVIEW_MESSAGE}*** –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑."
REVIEW_FINISHING_MESSAGE = "–°—ñ–∑–¥—ñ“£ –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å—ã“£—ã–∑ –∂—ñ–±–µ—Ä—ñ–ª–¥—ñü•≥üëè!"
REVIEW_FOR_CLIENT_MESSAGE = "–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å “õ–∞–±—ã–ª–¥–∞–Ω–¥—ã."

# main messages
NEW_ID_MESSAGE = "–ò–ò–ù –Ω–æ–º–µ—Ä–¥—ñ –∂—ñ–±–µ—Ä—É"
WELCOME_MESSAGE = f"""
–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ?!
"MAXIMUM" –æ“õ—ã—Ç—É –æ—Ä—Ç–∞–ª—ã“ì—ã–Ω—ã“£ –±–æ—Ç—ã–Ω–∞ “õ–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑‚ò∫Ô∏è
–¢–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ—Å—ñ–Ω –±—ñ–ª—É “Ø—à—ñ–Ω —Ç”©–º–µ–Ω–¥–µ –∫”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω ***{NEW_ID_MESSAGE}*** –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑‚§µÔ∏è\n
"""
SEND_ID_MESSAGE = "–ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑–¥—ñ –∂—ñ–±–µ—Ä—ñ“£—ñ–∑"
CHOOSE_TEST_MESSAGE = "–¢–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ—Å—ñ–Ω –∫”©—Ä—Å–µ—Ç—É"
UNSUBSCRIBE_MESSAGE = "–ë–æ—Ç “ù—ã–∑–º–µ—Ç—ñ–Ω –∞—è“õ—Ç–∞–¥—ã, “õ–∞–π—Ç–∞ –±–∞—Å—Ç–∞—É “Ø—à—ñ–Ω /start –∫–æ–º–∞–Ω–¥–∞—Å—ã–Ω –∂—ñ–±–µ—Ä—ñ“£—ñ–∑."
NO_USER_ID_MESSAGE = f"–ë–æ—Ç “õ—ã–∑–º–µ—Ç—ñ–Ω —Ç–æ–ª—ã“õ “õ–æ–ª–¥–∞–Ω—É “Ø—à—ñ–Ω ”©–∑ –ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑. –ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑–¥—ñ –∂—ñ–±–µ—Ä—É “Ø—à—ñ–Ω, ***{NEW_ID_MESSAGE}*** –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑."
NOT_SUBSCRIBED_MESSAGE = "–ë–æ—Ç “õ—ã–∑–º–µ—Ç—ñ–Ω —Ç–æ–ª—ã“õ “õ–æ–ª–¥–∞–Ω—É “Ø—à—ñ–Ω ”©–∑ –ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑."
SCHEDULE_MESSAGE = "–°–∞–±–∞“õ –∫–µ—Å—Ç–µ—Å—ñ–Ω –∫”©—Ä—É"
MAIN_KEYBOARD_SET = [NEW_ID_MESSAGE, CHOOSE_TEST_MESSAGE, SCHEDULE_MESSAGE, ATTENDANCE_MESSAGE, REVIEW_MESSAGE]
BOT_FAILURE_MESSAGE = "–ë–æ—Ç –∂“±–º—ã—Å—ã–Ω–¥–∞ “õ–∞—Ç–µ –∫–µ—Ç—Ç—ñ. –ë–∞—Å—ã–Ω–∞–Ω —Ç—ã—Ä—ã—Å—ã–ø –∫”©—Ä—ñ“£—ñ–∑!"

# main message functions
def no_test_data_found(user_id):
    return f"***{user_id}*** –ò–ò–ù –Ω–æ–º–µ—Ä—ñ –±–æ–π—ã–Ω—à–∞ –∞“õ–ø–∞—Ä–∞—Ç —Ç–∞–±—ã–ª–º–∞–¥—ã."

def id_succes_code(id):
    return f"üí°–°—ñ–∑–¥—ñ“£ –ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑: ***{id}***.\n–¢–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ—Å—ñ–Ω –±—ñ–ª—É “Ø—à—ñ–Ω ”©–∑ –Ω“±—Å“õ–∞“£—ã–∑–¥—ã —Ç–∞“£–¥–∞“£—ã–∑‚¨áÔ∏è"

def id_failure_code(id):
    return f"–ò–ò–ù –Ω–æ–º–µ—Ä—ñ“£—ñ–∑ ***{id}*** “õ–∞—Ç–µ –∂–∞–∑—ã–ª–¥—ãüö´\n–ù–æ–º–µ—Ä–¥—ñ “õ–∞–π—Ç–∞ –∂—ñ–±–µ—Ä—É—ñ“£—ñ–∑–¥—ñ —Å“±—Ä–∞–π–º—ã–∑."

def new_results(sheet_name):
    return f"–ñ–∞“£–∞ —Ç–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä—ñ —à—ã“õ—Ç—ã ‚Äì ***{sheet_name}***."

def get_string_from(dict):
    result = "“ö“±—Ç—Ç—ã“õ—Ç–∞–π–º—ã–∑ü•≥\n\nüìö –û“õ—É —Ñ–æ—Ä–º–∞—Ç—ã: –æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω\n\n"
    result += f"üéì –û“õ—É—à—ã–Ω—ã“£ –∞—Ç—ã-–∂”©–Ω—ñ: {list(list(dict.values()))[1]}\n"
    result += f"üè¢ –¢–æ–ø: {list(dict.values())[2]}\n"
    result += f"üìÑ –ù“±—Å“õ–∞: {list(dict.values())[3]}\n"
    result += f"üóìÔ∏è –ö“Ø–Ω—ñ: {list(dict.values())[4]}\n"
    result += f"üìä –ñ–∞–ª–ø—ã –±–∞–ª–ª: {list(dict.values())[5]}\n\n"
    result += "–¢–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ—Å—ñ:\n"
    result += f"‚úÖ –û“õ—É —Å–∞—É–∞—Ç—Ç—ã–ª—ã“ì—ã: {list(dict.values())[6]}/20\n"
    result += f"‚úÖ “ö–∞–∑–∞“õ—Å—Ç–∞–Ω —Ç–∞—Ä–∏—Ö—ã: {list(dict.values())[7]}/15\n"
    result += f"‚úÖ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞–ª—ã“õ —Å–∞—É–∞—Ç—Ç—ã–ª—ã“õ: {list(dict.values())[8]}/15\n"
    index = 9
    while index < len(dict.items()):
        key, value = list(dict.items())[index]
        if value != 'N/a':
            result += f'‚úÖ {key}: {value}/45\n'
        index += 1
    return result


# attendance fsm message functions
def convert_to_int(day):
        return int(day[1]) if day[0] == '0' else int(day)

def get_suffix(day):
    if day[1] == '6' or day[1] == '9' or day[1] == '0':
        return '—à—ã'
    else:
        return '—à—ñ'

def attendance_result(check, day, month, full_name):
    attendance = f"{check} –º–∏–Ω—É—Ç“õ–∞ –∫–µ—à—ñ–≥—ñ–ø –∫–µ–ª–¥—ñ"
    if check == '+':
        attendance = "“õ–∞—Ç—ã—Å—Ç—ã"
    elif check == '-':
        attendance = "“õ–∞—Ç—ã—Å–ø–∞–¥—ã"
    elif check == '=':
        return f"{convert_to_int(day)}-{get_suffix(day)} {MONTH_KZ[month]} –∫“Ø–Ω—ñ {full_name} —Å–∞–±–∞“õ—Ç–∞–Ω —Å“±—Ä–∞–Ω—ã–ø –∫–µ—Ç—Ç—ñ."    
    return f"{convert_to_int(day)}-{get_suffix(day)} {MONTH_KZ[month]} –∫“Ø–Ω—ñ {full_name} —Å–∞–±–∞“õ“õ–∞ {attendance}."

def date_failure_code(date):
    return f"–ñ—ñ–±–µ—Ä—ñ–ª–≥–µ–Ω –∫“Ø–Ω–Ω—ñ“£ —Ñ–æ—Ä–º–∞—Ç—ã “õ–∞—Ç–µ ***{date}*** üö´\n–ö“Ø–Ω –∂”ô–Ω–µ –∞–π–¥—ã “õ–∞–π—Ç–∞ –∂—ñ–±–µ—Ä—É—ñ“£—ñ–∑–¥—ñ —Å“±—Ä–∞–π–º—ã–∑."

# review message functions

def construct_review(name, review, assessment):
    return f"***–ê—Ç—ã-–∂”©–Ω—ñ:*** {name}\n***–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å:*** {review}\n***–ë–µ—Ä—ñ–ª–≥–µ–Ω –±–∞“ì–∞:*** {assessment}"
    